/**
 * A 'lucky' number is a natural number generated by a sieve, similar to how prime numbers are generated,
 * but instead of eliminating numbers based on their value, it eliminates them based on their position in
 * the remaining set. They are generated by the following procedure:
 *
 *   Start with the natural numbers. Delete every 2nd number, leaving 1 3 5 7 9 11 13 15 17 19 21 23 ...;
 *   the 2nd number remaining is 3, so delete every 3rd number, leaving 1 3 7 9 13 15 19 21 ...;
 *   the 3rd number remaining is 7, so delete every 7th number, leaving 1 3 7 9 13 15 21 ...;
 *   the 4th number remaining is 9, so delete every 9th number;
 *   ... etc.
 *
 * The first 10 lucky numbers are:
 *   1, 3, 7, 9, 13, 15, 21, 25, 31, 33, ...
 *
 * Write a generator function that lazily produces all the lucky numbers.
 */

export function* luckyNumbers() {
  yield 1;
  let generator = excludeEvery2nd(3);
  for (let i = 3; ; i++) {
    const lucky = generator.next().value;
    yield lucky;
    generator = excludeEveryNth(generator, i, lucky);
  }
}

export function* excludeEvery2nd(start) {
  for (let x = start; ; x += 2) {
    yield x;
  }
}

export function* excludeEveryNth(generator, start, n) {
  for (let i = start; ; i++) {
    let x = generator.next().value;
    if (i % n !== 0) {
      yield x;
    }
  }
}
